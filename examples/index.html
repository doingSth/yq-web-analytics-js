<!doctype html>
<html>
<head>
    <title>web-analytics</title>
    <meta charset="UTF-8">
    <script>
        (function(window, mta) {
            window.MeituanAnalyticsObject = mta;
            window[mta] = window[mta] || function() {
                    (window[mta].q = window[mta].q || []).push(arguments);
                };
        }(window, 'mta'));
        window.onload = function () {
            //页面名称
            mta('create', 'appPageName');
            //上报接口
            mta('config', 'beaconImage', 'http://localhost:8080/performance/report');
            (function sendTime(){
                var timing = performance.timing;
                var loadTime = timing.loadEventEnd - timing.navigationStart;//过早获取时,loadEventEnd有时会是0
                if(loadTime <= 0) {
                    // 未加载完，延迟200ms后继续times方法，直到成功
                    console.warn('200 ms')
                    setTimeout(function(){
                        sendTime();
                    }, 200);
                    return;
                } else {
                    console.warn('send')
                    mta('send', 'waterfall');
                    console.warn('send')
                    mta('send', 'page');
                }
            })()
        };
    </script>
    <script src="../dist/mta.min.js"></script>
</head>

<body>
    <h1>web-analytics</h1>
</body>
</html>
	<script></script>
